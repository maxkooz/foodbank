<!DOCTYPE html>
<html>
<head>
    <title>Volunteer Tasks</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        tr:hover {
            background-color: #f1f1f1;
        }

        .table-container {
            overflow-x: auto;
        }

        /* Set a specific width for the Food Bank City column */
        th:nth-child(3),
        td:nth-child(3) {
            width: 150px; /* Adjust the width as needed */
        }
    </style>
</head>
<body>

<h1>Volunteer Tasks</h1>

{% if error_msg %}
<p style="color:red;">{{error_msg}}</p>
{% endif %}

<div class="search-form">
    <form method="GET">
        <label for="q">Search:</label>
        <input type="text" id="q" name="q" value="{{ query }}">
        <button type="submit">Search</button>
    </form>
</div>

<div class="table-container">
    <table border="1">
        <thead>
            <tr>
                <th>Volunteer</th>
                <th>Task</th>
                <th>Food Bank City</th>
                <th>Task Time</th>
                {% if user.is_staff %}
                <th>Action</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for shift in shifts %}
            <tr>
                <form method="POST">
                    {% csrf_token %}
                    <input type="hidden" name="shift_id" value="{{ shift.id }}">
                    <td>{{ shift.volunteer.first_name }} {{ shift.volunteer.last_name }}</td>
                    <td>{{ shift.task.description }}</td>
                    <td>{{ shift.task.associated_food_bank.city }}</td>
                    <td>{{ shift.task.start_date_time|date:"F d, Y H:i" }} - {{ shift.task.end_date_time|date:"H:i" }}</td>
                    {% if user.is_staff %}
                    <td>
                        <button type="submit" name="save">Save</button>
                        <button type="submit" formaction="{% url 'foodbank:volunteer_task_delete' %}" name="delete">Delete</button>
                    </td>
                    {% endif %}
                </form>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<h2>Add Volunteer Task</h2>
<form method="POST">
    {% csrf_token %}
    <label for="volunteer">Volunteer:</label>
    <select id="volunteer" name="volunteer">
        {% for volunteer in volunteers %}
        <option value="{{ volunteer.id }}">{{ volunteer.first_name }} {{ volunteer.last_name }}</option>
        {% endfor %}
    </select><br>
    <label for="task">Task:</label>
    <select id="task" name="task">
        {% for task in tasks %}
        <option value="{{ task.id }}">{{ task.description }} - {{ task.start_date_time|date:"F d, Y H:i" }} - {{ task.end_date_time|date:"H:i" }}</option>
        {% endfor %}
    </select><br>
    <button type="submit" name="add">Add Volunteer Task</button>
</form>

<h2>Return to Main Page</h2>
<button><a href="{% url 'foodbank:main_page' %}" style="text-decoration: none; color: black;">Main Page</a></button>

</body>
</html>
